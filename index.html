<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏ï‡πä‡∏∞ (‡πÅ‡∏ö‡∏ö Real-time)</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background-color: #f4f4f4;
      margin: 0;
      padding: 20px;
    }
    .container {
      max-width: 600px;
      margin: auto;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .input-group {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin-bottom: 20px;
    }
    .input-item {
      display: flex;
      justify-content: space-between;
      width: 100%;
      max-width: 300px;
    }
    label {
      white-space: nowrap;
    }
    button {
      background-color: #28a745;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 5px;
      cursor: pointer;
    }
    .table-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
    }
    .table {
      border: 2px solid #333;
      padding: 10px;
      border-radius: 10px;
      background-color: lightgreen;
      width: 120px;
      text-align: center;
      position: relative;
    }
    .remove-btn {
      background-color: red;
      color: white;
      border: none;
      padding: 5px;
      border-radius: 5px;
      cursor: pointer;
      position: absolute;
      bottom: 5px;
      left: 50%;
      transform: translateX(-50%);
    }
    .notification {
      margin-top: 20px;
      background-color: #333;
      color: white;
      padding: 10px;
      border-radius: 5px;
      display: none;
    }
    #clock {
      font-size: 18px;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div id="clock"></div>
    <h1>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏ï‡πä‡∏∞ (Real-time)</h1>
    <div class="input-group">
      <div class="input-item">
        <label for="tableNumber">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡πÇ‡∏ï‡πä‡∏∞:</label>
        <input type="number" id="tableNumber" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡πÇ‡∏ï‡πä‡∏∞" min="1">
      </div>
      <div class="input-item">
        <label for="duration">‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ (‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ):</label>
        <input type="number" id="duration" value="15" min="1">
      </div>
      <button onclick="addTable()">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏ï‡πä‡∏∞</button>
    </div>
    <div class="notification" id="notification"></div>
    <div class="table-container" id="tables"></div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

  <script>
    // üîß ‡πÉ‡∏™‡πà config ‡∏Ç‡∏≠‡∏á Firebase ‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      databaseURL: "https://YOUR_PROJECT_ID.firebaseio.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const showNotification = (msg) => {
      const el = document.getElementById("notification");
      el.textContent = msg;
      el.style.display = "block";
      setTimeout(() => (el.style.display = "none"), 3000);
    };

    const addTable = () => {
      const number = parseInt(document.getElementById("tableNumber").value);
      const duration = parseInt(document.getElementById("duration").value) || 15;

      if (isNaN(number) || number < 1) {
        showNotification("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡πÇ‡∏ï‡πä‡∏∞‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");
        return;
      }

      const ref = db.ref("tables/" + number);
      ref.once("value").then(snapshot => {
        if (snapshot.exists()) {
          showNotification(`‡πÇ‡∏ï‡πä‡∏∞ ${number} ‡∏ñ‡∏π‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß`);
        } else {
          const now = Date.now();
          ref.set({ startTime: now, duration: duration });
          showNotification(`‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏ï‡πä‡∏∞ ${number} ‡πÅ‡∏•‡πâ‡∏ß`);
        }
      });
    };

    const removeTable = (number) => {
      db.ref("tables/" + number).remove();
      showNotification(`‡∏•‡∏ö‡πÇ‡∏ï‡πä‡∏∞ ${number}`);
    };

    const renderTables = (tables) => {
      const container = document.getElementById("tables");
      container.innerHTML = "";

      Object.entries(tables || {}).forEach(([number, data]) => {
        const elapsed = Math.floor((Date.now() - data.startTime) / 1000);
        const remaining = Math.max(0, data.duration - elapsed);

        if (remaining <= 0) {
          removeTable(number);
          return;
        }

        const div = document.createElement("div");
        div.className = "table";
        div.innerHTML = `
          <p>‡πÇ‡∏ï‡πä‡∏∞ ${number}</p>
          <p>‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏ß‡∏•‡∏≤: ${remaining} ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</p>
          <button class="remove-btn" onclick="removeTable(${number})">‡∏≠‡∏≠‡∏Å</button>
        `;
        container.appendChild(div);
      });
    };

    const startClock = () => {
      setInterval(() => {
        document.getElementById("clock").textContent =
          "‡πÄ‡∏ß‡∏•‡∏≤: " + new Date().toLocaleTimeString("th-TH", { hour12: false });
      }, 1000);
    };

    const listenToDatabase = () => {
      db.ref("tables").on("value", snapshot => {
        renderTables(snapshot.val());
      });
    };

    window.onload = () => {
      startClock();
      listenToDatabase();
    };
  </script>
</body>
</html>
